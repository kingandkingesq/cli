#!/usr/bin/env CLI_NAME=cli bash-cli-part

help() {
    cat << EOF
Command
    ${CLI_COMMAND[@]}

Summary
    Test if a file exists and is older than another file.

Description
    Argument $1 is the path to the generated file.

    Argument $2 is the source from which the generated file depends.
    
    Success if the generated file exists and is older than the source 
    file, otherwise failure.
EOF
}

::cli::cache::test::inline() {
    local CACHE="$1"
    local SOURCE="$2"

    [[ -f "${CACHE}" ]] && [[ "${SOURCE}" -ot "${CACHE}" ]]
}

self_test() {
    cli::temp::file 
    local OLD="${REPLY}"
    
    cli::temp::file
    local NEW="${REPLY}"

    ! ${CLI_COMMAND[@]} -- 'no_cache_file' "${OLD}" || cli::assert
    ! ${CLI_COMMAND[@]} -- "${OLD}" "${OLD}" || cli::assert
    ! ${CLI_COMMAND[@]} -- "${OLD}" "${NEW}" || cli::assert
    ${CLI_COMMAND[@]} -- "${NEW}" "${OLD}" || cli::assert
}
